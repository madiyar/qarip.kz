---
import dayjs from 'dayjs';
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const posts = (await getCollection('blog')).sort(
	(a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf()
);
---
<Layout title="Мақалалар — Qarip">
  <section class="max-w-7xl mx-auto dark:text-white">
    <h1 class="page-title mb-8">Мақалалар</h1>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
      {posts.map(post => (
        <article class="shadow-xl rounded-xl shadow-brand/10">
          <a
            href={`/blog/${post.slug}/`}
            class="hover:text-brand"
          >
            <Image src={post.data.cover} alt={post.data.title} class="rounded-t-xl" />
            <div class="p-4">
              <h2 class="text-xl">{post.data.title}</h2>
              {post.data.pubDate && (
                <p>{dayjs(post.data.pubDate).format('DD.MM.YYYY')}</p>
              )}
            </div>
          </a>
        </article>
      ))}
    </div>
  </section>
</Layout>
