---
import dayjs from 'dayjs';
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';

// const posts = await Astro.glob("../assets/blog/*.**");
const images = await Astro.glob("/src/assets/blog/*").then(files => {
  return files.map(file => file.default);
});


const filename = (str: string) => {
  const arr = str.match(/([-_a-zA-Z0-9]+)\./) || [];
  if (arr?.length > 1) {
    return arr[1].split('_');
  }
  return '';
}

const getDay = (src: string) => dayjs(filename(src)[0]).unix();

---

<Layout title="Мақалалар — Qarip">
  <section class="max-w-7xl mx-auto">
    <h1 class="page-title mb-8">Мақалалар</h1>
    <div class="grid grid-cols-3 gap-5">
      {images.sort((a,b) => getDay(b.src) - getDay(a.src)).map(item => (
        <a href={`https://www.instagram.com/p/${filename(item.src)[1]}/`} target="_blank" rel="noopener norefferer">
          <Image src={item} alt="" class="aspect-square object-cover hover:shadow-xl cursor-pointer" />
          </a>
      ))}
    </div>
  </section>
</Layout>
<style>
  .socials a {
    @apply hover:scale-110 transition-all;
  }
</style>